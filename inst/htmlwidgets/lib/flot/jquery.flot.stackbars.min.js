(function(b){var a={series:{stack_neg:null}};function c(g){var e={};var d={};function f(o,k,n){var h;var j=o.getData();var m=true;for(h=0;h<j.length;h++){if(!j[h].bars.show&&(j[h].lines&&j[h].lines.show)){if(j[h].stack_neg){m=false;break}}}if(k.stack_neg==null||!m||!k.bars.show){return}var l=[];horizontal=k.bars.horizontal;keyOffset=horizontal?1:0;accumulateOffset=horizontal?0:1;for(h=0;h<n.points.length;h+=n.pointsize){if(!e[n.points[h+keyOffset]]){e[n.points[h+keyOffset]]=0}if(!d[n.points[h+keyOffset]]){d[n.points[h+keyOffset]]=0}l[h+keyOffset]=n.points[h+keyOffset];if(n.points[h+accumulateOffset]>0){l[h+accumulateOffset]=n.points[h+accumulateOffset]+e[n.points[h+keyOffset]];l[h+2]=e[n.points[h+keyOffset]];e[n.points[h+keyOffset]]+=n.points[h+accumulateOffset]}else{l[h+accumulateOffset]=n.points[h+accumulateOffset]+d[n.points[h+keyOffset]];l[h+2]=d[n.points[h+keyOffset]];d[n.points[h+keyOffset]]+=n.points[h+accumulateOffset]}}n.points=l}g.hooks.processDatapoints.push(f)}b.plot.plugins.push({init:c,options:a,name:"stackbars",version:"1.0"})})(jQuery);